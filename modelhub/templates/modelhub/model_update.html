{% extends 'contents/base.html' %}

{% block title %}{{ model.name }} - ìˆ˜ì •{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="custom-breadcrumb-item">
            <a href="{% url 'modelhub:model_list' %}">
                <i class="bi bi-box-seam"></i> ëª¨ë¸ í—ˆë¸Œ
            </a>
        </li>
        <li class="custom-breadcrumb-item">
            <a href="{% url 'modelhub:model_detail' model.id %}">
                <i class="bi bi-eye"></i> {{ model.name }}
            </a>
        </li>
        <li class="custom-breadcrumb-item active">
            <a href="#">
                <i class="bi bi-pencil"></i> ìˆ˜ì •
            </a>
        </li>
    </ol>
</nav>
{% endblock breadcrumb %}

{% block content %}
<div class="container">
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">
                <i class="bi bi-pencil"></i> ëª¨ë¸ ìˆ˜ì •
            </h5>
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}
                
                <div class="row">
                    <div class="col-md-8">
                        <!-- ì†ŒìŠ¤ ì •ë³´ (ì½ê¸° ì „ìš©) -->
                        <div class="alert alert-info">
                            <strong>ì†ŒìŠ¤:</strong> 
                            <span class="badge bg-{{ model.get_source_badge_class }}">
                                {{ model.get_source_display }}
                            </span>
                            <br>
                            <small class="text-muted">
                                â„¹ï¸ ì†ŒìŠ¤ì™€ ì›ë³¸ íŒŒì¼ì€ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ë¦„, ì‘ì—… ìœ í˜•, ì„¤ëª…, í™œì„±í™” ìƒíƒœë§Œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                            </small>
                        </div>

                        <!-- ëª¨ë¸ ì´ë¦„ -->
                        <div class="mb-3">
                            <label for="{{ form.name.id_for_label }}" class="form-label">
                                <i class="bi bi-tag"></i> ëª¨ë¸ ì´ë¦„ <span class="text-danger">*</span>
                            </label>
                            {{ form.name }}
                            {% if form.name.errors %}
                                <div class="text-danger">{{ form.name.errors }}</div>
                            {% endif %}
                        </div>

                        <!-- ì‘ì—… ìœ í˜• -->
                        <div class="mb-3">
                            <label for="{{ form.task_type.id_for_label }}" class="form-label">
                                <i class="bi bi-gear"></i> ì‘ì—… ìœ í˜• <span class="text-danger">*</span>
                            </label>
                            {{ form.task_type }}
                            {% if form.task_type.help_text %}
                                <div class="form-text">
                                    <i class="bi bi-info-circle"></i> {{ form.task_type.help_text }}
                                </div>
                            {% endif %}
                            {% if form.task_type.errors %}
                                <div class="text-danger">{{ form.task_type.errors }}</div>
                            {% endif %}
                            
                            <!-- ì‘ì—… ìœ í˜• ì•ˆë‚´ -->
                            <div class="mt-2 alert alert-warning-subtle border-warning">
                                <small>
                                    <strong>ğŸ“Œ ì‘ì—… ìœ í˜•ë³„ ì§€ì› ìƒíƒœ:</strong><br>
                                    <span class="badge bg-success">ì™„ì „ ì§€ì›</span> ê°ì²´ íƒì§€ (Object Detection)<br>
                                    <span class="badge bg-secondary">ì¤€ë¹„ ì¤‘</span> ì´ë¯¸ì§€ ë¶„ë¥˜ (Image Classification)<br>
                                    <span class="badge bg-secondary">ì¤€ë¹„ ì¤‘</span> ì„¸ê·¸ë©˜í…Œì´ì…˜ (Segmentation)<br>
                                    <span class="badge bg-secondary">ì¤€ë¹„ ì¤‘</span> í•´ìƒë„ í–¥ìƒ (Super Resolution)<br>
                                    <span class="badge bg-secondary">ì¤€ë¹„ ì¤‘</span> ì´ë¯¸ì§€ ë³µì› (Image Restoration)
                                </small>
                            </div>
                        </div>

                        <!-- ì„¤ëª… -->
                        <div class="mb-3">
                            <label for="{{ form.description.id_for_label }}" class="form-label">
                                <i class="bi bi-card-text"></i> ì„¤ëª…
                            </label>
                            {{ form.description }}
                            {% if form.description.errors %}
                                <div class="text-danger">{{ form.description.errors }}</div>
                            {% endif %}
                        </div>

                        <!-- í™œì„±í™” ìƒíƒœ -->
                        <div class="mb-3">
                            <div class="form-check">
                                {{ form.is_active }}
                                <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
                                    <i class="bi bi-check-circle"></i> í™œì„±í™”
                                </label>
                            </div>
                            <small class="text-muted">
                                ë¹„í™œì„±í™”í•˜ë©´ vision_engineì—ì„œ ì„ íƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                            </small>
                            {% if form.is_active.errors %}
                                <div class="text-danger">{{ form.is_active.errors }}</div>
                            {% endif %}
                        </div>

                        <!-- ë²„íŠ¼ -->
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle"></i> ì €ì¥
                            </button>
                            <a href="{% url 'modelhub:model_detail' model.id %}" class="btn btn-outline-secondary">
                                <i class="bi bi-x-circle"></i> ì·¨ì†Œ
                            </a>
                        </div>
                    </div>

                    <!-- ì˜¤ë¥¸ìª½: ë©”íƒ€ë°ì´í„° ì •ë³´ (ì½ê¸° ì „ìš©) -->
                    <div class="col-md-4">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h6 class="card-title">
                                    <i class="bi bi-info-circle"></i> ë©”íƒ€ë°ì´í„° (ì½ê¸° ì „ìš©)
                                </h6>
                                <table class="table table-sm small mb-0">
                                    <tbody>
                                        {% if model.framework %}
                                        <tr>
                                            <th>í”„ë ˆì„ì›Œí¬</th>
                                            <td>{{ model.framework }}</td>
                                        </tr>
                                        {% endif %}
                                        {% if model.architecture %}
                                        <tr>
                                            <th>ì•„í‚¤í…ì²˜</th>
                                            <td>{{ model.architecture }}</td>
                                        </tr>
                                        {% endif %}
                                        {% if model.num_classes %}
                                        <tr>
                                            <th>í´ë˜ìŠ¤ ê°œìˆ˜</th>
                                            <td>{{ model.num_classes }}ê°œ</td>
                                        </tr>
                                        {% endif %}
                                        {% if model.file_size %}
                                        <tr>
                                            <th>íŒŒì¼ í¬ê¸°</th>
                                            <td>{{ model.get_file_size_display }}</td>
                                        </tr>
                                        {% endif %}
                                        <tr>
                                            <th>ì‚¬ìš© íšŸìˆ˜</th>
                                            <td>{{ model.usage_count }}íšŒ</td>
                                        </tr>
                                        <tr>
                                            <th>ë“±ë¡ì¼</th>
                                            <td>{{ model.created_at|date:"Y-m-d H:i" }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <hr>
                                <p class="small mb-0 text-muted">
                                    <i class="bi bi-lightbulb"></i> 
                                    í”„ë ˆì„ì›Œí¬, ì•„í‚¤í…ì²˜ ë“±ì€ ìë™ ì¶”ì¶œë˜ë¯€ë¡œ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Task type ë³€ê²½ ì‹œ ê²½ê³ 
document.addEventListener('DOMContentLoaded', function() {
    const taskTypeSelect = document.querySelector('select[name="task_type"]');
    if (taskTypeSelect) {
        const originalValue = taskTypeSelect.value;
        
        taskTypeSelect.addEventListener('change', function() {
            if (this.value !== originalValue && this.value !== 'object_detection') {
                alert('âš ï¸ í˜„ì¬ Vision Engineì€ "ê°ì²´ íƒì§€"ë§Œ ì™„ì „íˆ ì§€ì›í•©ë‹ˆë‹¤.\në‹¤ë¥¸ ì‘ì—… ìœ í˜•ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
            }
        });
    }
});
</script>
{% endblock %}